## AI精准教学平台｜产品需求文档（PRD）

- 文档版本：v1.0
- 适用范围：平台端（yqadmin）、校级管理端、教务管理端、教师端、学生/家长小程序
- 目标用户：平台管理员、租户管理员、教务人员、教师、学生、家长
- 目标：支撑多租户快速开通与隔离；教务一体化管理；AI 驱动作业/考试全流程与学情分析；AI 教案与知识点资源管理

## 一、背景与目标
- 背景：学校需要标准化教务管理、AI 批改、学情分析与个性化提升，提升教师教学效率与家校沟通质量。
- 核心目标：
  - 多租户一键开通、默认组织与权限模板。
  - 作业/考试线上化与 AI 批改、订正闭环。
  - 夜间自动计算班级与学生画像，驱动精准教学。
  - AI 教案生成与知识点/题库内容服务。

## 二、范围与不在范围
- 在范围：租户管理、组织架构、运维监控、教务配置、师生家校、作业/考试、AI 批改、AI 教案、知识点/题库、画像与看板。
- 不在范围（当前版本）：计费结算、第三方学籍/教务系统对接（另行立项）。

## 三、角色与权限（概述）
- 平台管理员（yqadmin）：租户全生命周期、模板与权限模型。
- 租户管理员（校级端）：组织架构、用户与角色分配、日志审计。
- 教务：设置、年级/班级、教师/学生、家长关系。
- 教师：作业、考试、AI 教案、知识点/题库、班级学情、学生画像。
- 学生/家长（小程序）：接收作业、提交、查看分析与错题。

## 四、业务术语
- 租户：学校单位，多租户隔离。
- 夜间任务：每日定时计算作业/考试统计、画像指标。
- 作业方案/评分配置：复用化布置与评分规则。

## 五、功能需求

### 5.1 平台端（yqadmin）
- 新增租户
  - 录入租户信息 → 租户设置（DB 链接） → 数据初始。
  - 初始内容：默认组织（教务、教师、家长）与角色菜单模板。
  - 约束：租户管理员权限在“数据初始前”配置生效；之后修改不影响已初始化租户。
- 登录与访问控制：登录页选择学校，租户管理员默认密码 123456（首登强制修改）。

### 5.2 校级管理端
- 组织架构
  - 机构管理：新增部门、添加子部门、层级管理。
  - 用户管理：新增用户（选部门、角色），成功后可登录并获得对应菜单。
  - 自动联动：教务新增教师时自动创建教师用户并授予教师角色。
- 运维与监控
  - 登录日志：可筛选 Web 与小程序端。
  - 操作日志：记录全量用户操作，可筛选导出。

### 5.3 教务管理端
- 设置：学科、教材、年级基础配置、考试方案（教师建考可选用）。
- 年级管理：新建年级 → 教材配置 → 新建班级 → 教师配置；一键升级（最高年级学生标记为“毕业”）。
- 教师管理：新增/导入教师并配置教学任务；自动创建用户并分配教师角色。
- 学生管理：新增/导入学生；家长关系设置；家长账号为手机号（默认密码 123456，首登强改）。

### 5.4 教师端
- 教师工作台：
  - 左侧：班级学情（作业完成、知识点掌握）、学情表现（成绩分布、成绩/名次升降）。
  - 右侧：作业提交与批改进度。
  - 夜间任务：每日重算并刷新看板。
- 学生画像：班级视图与学生详情；可切换班级；夜间任务刷新。
- 作业管理：
  - 视图：作业日历、已布置、提交与批改状态。
  - 布置：基于作业方案或自定义题型/数量/难度/范围；立即或定时推送（含确认）。
  - 推送后按钮变“撤回”；未推送可删除，已推送不可删除（仅可撤回）。
  - 下载：可按学生生成差异化作业（如配置支持）。
  - 上传：Web/小程序上传作业，进入 AI 批改队列。
  - AI 批改：展示状态与结果；依据评分配置自动分级并打标签；教师可人工修改，等级与标签同步更新。
  - 批改分析：提交率、得分分布、AI 分析报告与错题本；支持错题详情。
  - 作业详情：展示布置参数与范围。
- 考试管理：
  - 创建考试：选择考试方案 → 生成试卷 → 保存为考试计划。
  - 下载/上传试卷：按学生上传。
  - 批改状态：AI 未批改 → 待订正 → 已订正（全题订正后进入已订正列表）。
  - 计划详情：配置、试题与答案解析。
  - 计划状态：未开始（可编辑/删除）、进行中/已结束（不可编辑/删除）。
- AI 教案：基于教学大纲生成；支持预览、编辑、保存、导出。
- 知识点：左侧树选择，右侧展示内容详情。
- 题库：按知识点/大纲浏览；按关键词、题型、难度、题号 ID 搜索；题目详情含答案与解析。
- 设置：
  - 作业方案：新增/编辑，布置时可选。
  - 作业评分配置：按错题数/错误率设等级；可切换默认评分模式；AI 批改按配置自动定级。

### 5.5 学生/家长小程序
- 学生：接收/提交作业、查看批改与分析、错题本。
- 家长：绑定学生，查看学情分析、作业提醒与结果。

## 六、关键流程与状态机
- 租户开通：创建租户 → 配 DB → 数据初始 → 登录页出现学校项 → 租户管理员登录。
- 作业流程：布置（立即/定时）→ 推送/撤回 → 学生提交 → AI 批改 → 教师订正 → 批改分析/错题本 → 夜间刷新看板。
- 考试流程：创建计划/生成试卷 → 下载/上传 → AI 批改 → 待订正 → 已订正 → 分析报告。
- 状态机：
  - 作业推送：未推送 → 已推送（可撤回）。
  - 作业批改：待上传 → 待 AI 批改 → 已批改待确认 → 已确认/已订正。
  - 考试计划：未开始 → 进行中 → 已结束（后两者不可编辑/删除）。

## 七、数据模型（核心实体）
- 租户、组织机构、用户、角色、权限。
- 学科、教材、年级、班级、教师、学生、家长关系。
- 作业、作业题、学生作答、AI 批改结果、评分等级、标签、错题本。
- 考试计划、试卷、试题、答案解析、订正记录。
- 教学大纲、AI 教案、知识点、题库题目。
- 登录日志、操作日志（时间、用户、动作、对象、终端）。

## 八、非功能需求
- 安全：多租户隔离；RBAC 权限；日志审计；默认密码首登强改；数据脱敏与最小权限。
- 性能与 SLA：
  - AI 批改异步：单次平均 < 10s（并发排队）；夜间任务 06:00 前完成。
  - 批改与统计任务需幂等、可重试、失败告警。
- 可用性与容错：AI 服务熔断/降级；消息重试；任务补偿。
- 兼容性：主流浏览器；小程序为微信生态。
- 可观测性：AI 可用率、批改耗时、队列长度、夜间任务成功率、日志检索。

## 九、权限与菜单控制（概要）
- 采用 RBAC：菜单与操作权限按角色授予。
- 教务新增教师自动创建用户并授予教师角色。
- 平台端权限模板在租户初始化前配置并一次性下发。

## 十、报表与指标
- 班级学情：作业完成率、知识点掌握度、分层建议。
- 学情表现：成绩分布、成绩与名次升降趋势。
- 学生画像：薄弱知识点、错题聚类、个性化建议。
- 运维：登录/操作日志统计、租户活跃度。

## 十一、配置项
- 作业方案模板、默认评分模式、夜间任务时间窗口、默认密码策略、日志保留周期、导入模板与校验规则。

## 十二、验收标准（示例）
- 多租户：租户数据互不可见；新租户 3 步开通后可登录并具备默认组织与权限。
- 教务设置：考试方案可在教师端创建考试时被检索与引用。
- 作业：立即/定时推送可用；未推送可删除、已推送仅可撤回；AI 批改后按评分配置定级；人工修改能实时更新等级与标签。
- 考试：试卷批改流转符合“AI 未批改 → 待订正 → 已订正”；仅“未开始”计划可编辑/删除。
- 画像/看板：夜间任务次日 06:00 前刷新完成率 ≥ 99%。

## 十三、里程碑（建议）
- M1（3-4 周）：多租户与组织权限、教务设置、师生管理。
- M2（4-5 周）：作业全流程、AI 批改、评分配置、工作台学情。
- M3（4 周）：考试全流程、学生画像、错题本。
- M4（3 周）：AI 教案、知识点/题库完善、运维监控报表。

## 十四、风险与缓解
- AI 服务稳定性与延迟：引入队列、限流、熔断与重试；可降级为人工批改。
- 导入数据质量：模板规范、字段校验、错误行反馈与二次导入。
- 夜间任务拥塞：分批调度、可配置时间窗口、失败重跑与监控告警。
